# Phase 2: 提示词工程 - 学习总结

## 📚 本章概述

**提示词工程（Prompt Engineering）**是与大语言模型（LLM）交互的核心技能。掌握提示词工程，能让你用同样的模型获得 10 倍甚至 100 倍的质量提升。

**关键洞察：**

> 同样的问题，不同的提问方式，会得到截然不同的结果。提示词就是你与 AI 沟通的"编程语言"。

---

## 🎯 核心知识点

### 1. 提示词工程的三大核心原则

这是提示词工程的基石，掌握这三个原则，你就掌握了 80%的技巧。

#### 原则一：Context（上下文）

**定义：** 提供足够的背景信息，让模型理解你的意图和场景。

**为什么重要？**

- LLM 不知道你的具体情况
- 缺少上下文会导致模型"猜测"你的意图
- 上下文决定了回答的相关性

**对比示例：**

❌ **糟糕（无上下文）：**

```
写一篇文章
```

结果：AI 会反问你想写什么类型、什么主题...

✅ **优秀（有上下文）：**

```
为一个面向初学者的编程博客写一篇关于TypeScript基础的文章，
重点解释类型系统如何帮助减少bug。目标读者是有JavaScript经验
但从未使用过TypeScript的开发者。
```

结果：AI 直接生成符合要求的高质量文章。

**上下文包括什么？**

- 使用场景（博客、技术文档、商业报告等）
- 目标受众（初学者、专家、管理层等）
- 具体目标（解决什么问题、达成什么目的）
- 背景信息（相关的专业领域、技术栈等）

---

#### 原则二：Role（角色）

**定义：** 告诉模型应该扮演什么角色，以获得更专业、更符合预期的输出。

**为什么重要？**

- 不同角色的回答风格、专业程度、术语使用完全不同
- 角色设定会影响 AI 的"思维模式"
- 训练数据中包含大量不同角色的文本，角色能激活相应的知识

**示例：**

```
你是一位资深的TypeScript架构师，拥有10年大型企业项目经验。
请审查以下代码并提供专业的优化建议...
```

**角色设定的影响：**

| 角色       | 影响                                     |
| ---------- | ---------------------------------------- |
| 资深架构师 | 使用专业术语、关注架构设计、考虑可扩展性 |
| 技术导师   | 解释清晰、循序渐进、注重基础概念         |
| 代码审查者 | 关注代码质量、性能、最佳实践             |
| 产品经理   | 关注用户体验、商业价值、功能优先级       |

**技巧：**

- 选择与任务最相关的角色
- 可以组合多个角色："资深前端工程师 + UI/UX 设计师"
- 角色越具体，输出越精准

---

#### 原则三：Constraints（约束）

**定义：** 明确指定输出的格式、长度、风格、限制条件。

**为什么重要？**

- 控制输出的形式，确保可用性
- 避免不必要的内容（节省 tokens）
- 提高输出的一致性和可预测性

**约束的类型：**

**1. 格式约束**

```
- 使用Markdown格式
- 以JSON格式输出
- 分3段，每段不超过100字
```

**2. 长度约束**

```
- 用3句话总结
- 不超过300字
- 列出前5个要点
```

**3. 风格约束**

```
- 使用简洁的技术术语
- 友好、鼓励性的语气
- 正式的商务报告风格
```

**4. 内容约束**

```
- 只关注性能优化方面
- 不要包含实现细节
- 避免使用专业术语
```

**示例：**

```
请用3句话总结这篇文章的主要观点。
每句话不超过20个字。
使用简洁的技术术语。
```

---

### 2. 进阶技巧：Chain of Thought (CoT)

**什么是 CoT？**

Chain of Thought（思维链）是一种让模型"展示推理过程"的提示词技术。

**核心思想：**

> 让 AI 像人类一样"想出声"，展示从问题到答案的每一步推理。

**为什么有效？**

1. **提高准确率**：分步推理减少跳步错误
2. **可验证性**：能看到每一步的逻辑，容易发现错误
3. **可调试性**：知道哪一步出错了
4. **可解释性**：理解 AI 是如何得出结论的

**如何使用 CoT？**

在提示词中加入以下语句：

- "让我们一步步思考"
- "请展示你的推理过程"
- "请一步步计算"
- "请列出每一步的推理"

**示例对比：**

❌ **不使用 CoT：**

```
问题：小明有15个苹果，他给了小红1/3，然后自己又吃了2个。
剩下的苹果平均分给3个朋友，每人能得到几个？

请给出答案。
```

回答：每人 2 个。（可能对，但看不到推理过程）

✅ **使用 CoT：**

```
问题：小明有15个苹果，他给了小红1/3，然后自己又吃了2个。
剩下的苹果平均分给3个朋友，每人能得到几个？

请一步步展示你的计算过程。
```

回答：

```
让我一步步计算：
1. 小明给小红的苹果数：15 × 1/3 = 5个
2. 小明剩余：15 - 5 = 10个
3. 小明吃掉2个后：10 - 2 = 8个
4. 分给3个朋友：8 ÷ 3 ≈ 2.67个（每人2个，剩余2个）

答案：每人可以得到2个完整的苹果。
```

**CoT 最适合的场景：**

- 数学计算题
- 逻辑推理题
- 复杂的决策分析
- 多步骤的问题求解
- 需要验证的任务

**注意事项：**

- CoT 不保证推理过程 100%正确
- 需要人工验证关键步骤
- 会消耗更多 tokens（但值得）

---

### 3. 结构化输出：JSON Mode

**什么是结构化输出？**

强制 LLM 输出特定格式的数据（通常是 JSON），便于程序解析和处理。

**为什么需要？**

**问题：** 自然语言输出难以解析

```
AI: 这个人叫张三，住在北京，今年30岁...
```

你需要写复杂的正则表达式或文本解析器。

**解决：** 结构化 JSON 输出

```json
{
  "name": "张三",
  "location": "北京",
  "age": 30
}
```

直接用 `JSON.parse()` 解析即可！

**如何实现？**

**关键要素：**

1. 明确要求"纯 JSON，不要任何额外说明"
2. 提供具体的 JSON 结构模板
3. 使用 TypeScript 接口定义预期结构

**示例提示词：**

```
从以下文本中提取关键信息，并以JSON格式输出：

文本：张三将于2024年3月15日在北京参加技术大会。

要求输出格式（纯JSON，不要任何额外说明）：
{
  "person": "人名",
  "location": "地点",
  "date": "日期",
  "event": "事件"
}
```

**TypeScript 集成：**

```typescript
interface ExtractedData {
  person: string;
  location: string;
  date: string;
  event: string;
}

// 解析AI的响应
const data: ExtractedData = JSON.parse(response);
```

**实际应用场景：**

- 信息提取（NER - 命名实体识别）
- 数据格式转换
- API 响应生成
- 批量数据处理
- 表单填充

---

## 💻 代码示例回顾

### 示例 1：基础提示词对比（05-prompt-basics.ts）

**演示内容：**

- 对比糟糕 vs 优秀的提示词
- 展示三原则的实际应用

**核心代码：**

```typescript
const badPrompt = "写一篇文章";

const goodPrompt = `你是一位资深的技术写作专家。

请为一个面向初学者的编程博客写一篇关于TypeScript基础的文章。

目标读者：有JavaScript经验但从未使用过TypeScript的开发者
重点内容：解释类型系统如何帮助减少bug
文章要求：
- 长度：300字左右
- 语言：简洁易懂
- 结构：包含引言、核心观点、实际示例、总结`;
```

**运行命令：**

```bash
npx tsx src/05-prompt-basics.ts
```

---

### 示例 2：思维链推理（06-chain-of-thought.ts）

**演示内容：**

- 对比直接回答 vs CoT 推理
- 数学题和复杂推理的应用

**核心代码：**

```typescript
const problem = `小明有15个苹果，他给了小红其中的1/3，
然后自己又吃了2个。剩下的苹果平均分给3个朋友，
每人能得到几个？`;

const cotPrompt = `${problem}

请一步步展示你的计算过程，列出每一步的算式和结果。
最后给出最终答案。`;
```

**运行命令：**

```bash
npx tsx src/06-chain-of-thought.ts
```

---

### 示例 3：结构化输出（07-structured-output.ts）

**演示内容：**

- 从文本提取信息并输出 JSON
- TypeScript 类型定义
- JSON 解析和使用

**核心代码：**

```typescript
interface ExtractedData {
  person: string;
  location: string;
  date: string;
  event: string;
}

const prompt = `从以下文本中提取关键信息，并以JSON格式输出：

文本：${text}

要求输出格式（纯JSON，不要任何额外说明）：
{
  "person": "人名",
  "location": "地点",
  "date": "日期",
  "event": "事件"
}`;
```

**运行命令：**

```bash
npx tsx src/07-structured-output.ts
```

---

## 🎓 提示词工程的黄金法则

### 1. 明确具体

**原则：** 不要让模型猜测你想要什么。

❌ 模糊：

```
帮我写代码
```

✅ 明确：

```
用TypeScript编写一个函数，计算两个日期之间的天数差。
要求包含类型注解和JSDoc注释。
```

---

### 2. 提供示例（Few-Shot Learning）

**原则：** 给几个例子比纯文字描述更有效。

```
将以下文本分类为"正面"或"负面"：

示例：
文本："这个产品太棒了！" -> 正面
文本："质量很差，不推荐。" -> 负面

现在请分类：
文本："价格有点贵，但物有所值。" -> ?
```

---

### 3. 迭代优化

**原则：** 第一版提示词通常不是最好的，需要不断测试和改进。

**迭代流程：**

1. 写初版提示词
2. 测试输出质量
3. 识别问题（太长？太短？不够专业？）
4. 调整提示词
5. 重复 2-4 直到满意

---

### 4. 测试边界情况

**原则：** 用各种输入测试你的提示词是否稳健。

**测试用例：**

- 空输入
- 极端值
- 错误格式
- 边界条件
- 非预期输入

---

## 📊 提示词质量自检清单

在发送提示词前，问自己这些问题：

- [ ] **上下文充足**：AI 能理解我的场景和目标吗？
- [ ] **角色明确**：我指定了合适的角色吗？
- [ ] **约束清晰**：输出格式、长度、风格都明确了吗？
- [ ] **示例充分**：需要示例的话，我提供了吗？
- [ ] **可测试性**：我能验证输出是否正确吗？
- [ ] **边界考虑**：我考虑过异常情况了吗？

---

## 🚀 实战技巧总结

### 场景 1：写作任务

**公式：**

```
角色设定 + 目标受众 + 内容主题 + 写作风格 + 长度限制
```

**示例：**

```
你是一位资深的科技记者。
为对AI感兴趣的普通读者写一篇关于GPT-4的科普文章。
要求：通俗易懂、生动有趣、800字左右。
```

---

### 场景 2：代码生成

**公式：**

```
技术角色 + 编程语言 + 功能描述 + 代码要求 + 注释要求
```

**示例：**

```
你是一位资深的React开发者。
用TypeScript编写一个自定义Hook，用于管理表单状态。
要求：
- 支持验证
- 包含完整的类型定义
- 添加JSDoc注释
```

---

### 场景 3：数据分析

**公式：**

```
分析角色 + 数据描述 + 分析目标 + 输出格式
```

**示例：**

```
你是一位数据分析师。
分析以下销售数据，找出销售额下降的原因。
请以JSON格式输出：原因列表和改进建议。
```

---

## 🔄 常见问题与解决方案

### Q1: AI 的回答太长/太短

**解决：** 在约束中明确长度

```
- 用3句话总结
- 控制在300字以内
- 列出前5个要点
```

---

### Q2: AI 的回答不够专业

**解决：** 设定专业角色

```
你是一位拥有10年经验的资深XX专家...
```

---

### Q3: AI 理解错了我的意图

**解决：** 提供更多上下文

```
背景：我是一个初学者
目标：学习TypeScript基础
问题：...
```

---

### Q4: JSON 输出包含额外文字

**解决：** 强调"纯 JSON"

```
要求输出格式（纯JSON，不要任何额外说明）：
{...}
```

---

## 📈 进阶学习建议

1. **实践为王**：理论再多不如实际尝试
2. **建立模板库**：把好用的提示词保存下来
3. **学习优秀案例**：研究别人的提示词
4. **持续迭代**：不断优化你的提示词

---

## ✅ 本章核心要点回顾

1. **三大原则**：Context + Role + Constraints 是基石
2. **CoT 思维链**：复杂任务必备，展示推理过程
3. **结构化输出**：JSON 格式方便程序处理
4. **迭代优化**：好提示词是改出来的
5. **测试验证**：确保提示词稳健可靠

---

**恭喜你完成 Phase 2 的学习！** 🎉

掌握了提示词工程，你已经拥有了与 AI 高效沟通的能力。这是使用 LLM 最核心的技能之一。

**下一步：** 完成 [PHASE_2_QUIZ.md](file:///Users/perlou/Desktop/personal/go-blog/ai-learning-ts/docs/PHASE_2_QUIZ.md) 来检验学习成果！
